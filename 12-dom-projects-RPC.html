<!DOCTYPE html>
<html>
  <head>
    <title> Rock Paper Scissors </title>
    <link rel="stylesheet" href="12-dom-RPC-style.css">
  </head>

  <body>
    <p> Rock Paper Scissors  </p>

    <div class="container"> 
      <button class="rock" id="rockBtn"> Rock </button>
      <button class="but" id="paperBtn"> Paper </button>
      <button class="scis" id="scisBtn"> Scissors </button>
    </div>
    <p class="js-message"></p>
    <p class="js-your-choice"> You: ... </p>
    <p class="js-comp-choice"> Computer: ... </p>
    
    <p> Wins: <span class="js-wins">0</span>, Lose: <span class="js-lose">0</span>, Ties: <span class="js-ties">0</span> </p>

    <div class="clearContainer"> 
      <button class="clear" id="clearBtn"> Reset Score </button>
    </div>

    <script>
      // ******************************
      // Rock Paper Scissors Game:
      // ******************************

      const yourChoice = document.querySelector('.js-your-choice'); 
      const computer_Choice =  document.querySelector('.js-comp-choice'); 
      const wins_message = document.querySelector('.js-wins'); 
      const lose_message = document.querySelector('.js-lose'); 
      const ties_message = document.querySelector('.js-ties'); 


      const resultSheet = {
          wins: 0, 
          lose: 0, 
          ties: 0
        }

        // We want to load the saved score 
        // So we should get the item and change it to an JS object
        // And then update the result sheet based on that:
        const savedScore = JSON.parse(localStorage.getItem('score')); 
        
        // Now update the result sheet:
        if (savedScore) {
          resultSheet.lose = savedScore.lose;
          resultSheet.wins = savedScore.wins;
          resultSheet.ties = savedScore.ties;
        }
        
        // Random comp choice function:
        function compChoice() {
          // 1: rock  2: paper  3: scissors
          let compChoice = 0; 
          let res = ''; 
          // generating a random number from 1-3
          compChoice = Math.floor(Math.random() * 3) + 1; 
          if (compChoice === 1){
            res = 'Rock'; 
            computer_Choice.innerText = 'Computer: Rock'
          } else if (compChoice === 2){
            res = 'Paper';
            computer_Choice.innerText = 'Computer: Paper'
          } else {
            res = 'Scissors'; 
            computer_Choice.innerText = 'Computer: Scissors'
          }
          return res
        }
        
        // Checks who is the winner based on the 
        // player and computer choice. 
        function winner(Pchoice, Cchoice) {
          playerChoice = Pchoice;
          computerChoice = Cchoice; 
        
          if ((playerChoice === 'Scissors' && computerChoice === 'Rock') || 
          (playerChoice === 'Rock' && computerChoice === 'Paper') || 
          (playerChoice === 'Paper' && computerChoice === 'Scissors')) 
          {
            return 'Computer Won!';
        
          } else if ((playerChoice === 'Scissors' && computerChoice === 'Paper') || (playerChoice === 'Rock' && computerChoice === 'Scissors') || (playerChoice === 'Paper' && computerChoice === 'Rock')) {
            return 'You Won!'; 
        
          } else if ((playerChoice === 'Scissors' && computerChoice === 'Scissors') || (playerChoice === 'Rock' && computerChoice === 'Rock') || (playerChoice === 'Paper' && computerChoice === 'Paper')) {
            return 'No one won, tie game...'; 
          }
        }
        
        // Update the res based on the message, and save the result in the local storage
        function updateResult(res){
          if (res == 'Computer Won!') {
            resultSheet.lose += 1
          } else if (res == 'You Won!') {
            resultSheet.wins += 1
          } else if (res == 'Clear') {
            resultSheet.ties = 0
            resultSheet.wins = 0
            resultSheet.lose = 0
          } else {
            resultSheet.ties += 1
          }
        
          // SAVE SCORE TO LOCAL STORAGE HERE
          localStorage.setItem('score', JSON.stringify(resultSheet));
          console.log("Updated score:", resultSheet);
          lose_message.innerHTML = resultSheet.lose; 
          wins_message.innerHTML = resultSheet.wins; 
          ties_message.innerHTML = resultSheet.ties; 
        }
        
        // This is the functionality of the message
        // message_functionality: str -> str
        function message_functionality(res) {
          // It takes the res, and updates the message based on that
          // If res = 'Computer Won!' --> Then message is 'Computer Won!'
          // If res = 'You Won!' --> Then message is 'You Won!'
          // If res = 'No one won, tie game...' --> Then message is 'No one won, tie game...'

          // Steps:
          // 1.  When res = 'You Won!' -> text change to 'You Won!', and so on
            const message = document.querySelector('.js-message');

            if (res === 'You Won!'){
              message.innerHTML = 'You won!';
            } else if (res === 'Computer Won!') {
              message.innerHTML = 'Computer won!';
            } else if (res === 'No one won, tie game...')  {
              message.innerHTML = 'No one won, tie game...';
            }

        }



        console.log('Choose your element.')
        // Player choice:
        let playerChoice = '';
        let computerChoice = '';
        
        document.getElementById("rockBtn").addEventListener("click", function(
        ){
          playerChoice = 'Rock'; 
          computerChoice = compChoice();
          
          yourChoice.innerText = 'You: Rock';

          console.log('You: ' + playerChoice); 
          console.log('Computer: ' + computerChoice);
        
          res = winner(playerChoice, computerChoice); 
          console.log(res);

          updateResult(res); 
          message_functionality(res); 
        }); 
        
        document.getElementById("paperBtn").addEventListener("click", function() {
          playerChoice = 'Paper'; 
          computerChoice = compChoice(); 
          yourChoice.innerText = 'You: Paper';

          console.log('You: ' + playerChoice); 
          console.log('Computer: ' + computerChoice);
        
          res = winner(playerChoice, computerChoice); 
          console.log(res);
        
          updateResult(res); 

          message_functionality(res); 

        });
        
        document.getElementById("scisBtn").addEventListener("click", function(){
          playerChoice = 'Scissors'; 
          computerChoice = compChoice(); 
          yourChoice.innerText = 'You: Scissors';

          console.log('You: ' + playerChoice); 
          console.log('Computer: ' + computerChoice);
        
          res = winner(playerChoice, computerChoice); 
          console.log(res);

          updateResult(res);

          message_functionality(res); 
        });
        
        document.getElementById("clearBtn").addEventListener("click", function(){
          updateResult('Clear'); 
        }); 
        
        // Now the conditions:
    </script> 

  </body>
</html>